version: 3

tasks:
  build:
    cmds:
      - MY_UID="$(id -u)" MY_GID="$(id -g)" docker compose -f docker-compose.dev.yml build
  up:
    cmds:
      - MY_UID="$(id -u)" MY_GID="$(id -g)" docker compose -f docker-compose.dev.yml up -d
  down:
    cmds:
      - MY_UID="$(id -u)" MY_GID="$(id -g)" docker compose -f docker-compose.dev.yml down
  make-migrations:
    cmds:
      - MY_UID="$(id -u)" MY_GID="$(id -g)" docker compose -f docker-compose.dev.yml run --rm backend alembic revision --autogenerate
  migrate:
    cmds:
      - MY_UID="$(id -u)" MY_GID="$(id -g)" docker compose -f docker-compose.dev.yml run --rm backend alembic upgrade head
